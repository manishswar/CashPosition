{
"name":"sap.apb.makit.library-preload",
"dependencies":["sap.ui.core.library-preload"],
"modules":{	"sap.apb.makit.Chart":"jQuery.sap.declare('sap.apb.makit.Chart');jQuery.sap.require('sap.apb.makit.library');jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend('sap.apb.makit.Chart',{metadata:{publicMethods:['getSelectedCategory','getSelectedSeries','getNumberOfCategories','refreshData'],library:'sap.apb.makit',properties:{'type':{type:'sap.apb.makit.ChartType',group:'Appearance',defaultValue:sap.apb.makit.ChartType.Column},'categorySortOrder':{type:'sap.apb.makit.SortOrder',group:'Misc',defaultValue:sap.apb.makit.SortOrder.None},'dataSource':{type:'string',group:'',defaultValue:null},'height':{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:'100%'},'legendPosition':{type:'sap.apb.makit.LegendPosition',group:'Appearance',defaultValue:sap.apb.makit.LegendPosition.None},'lineThickness':{type:'float',group:'Appearance',defaultValue:1},'maxSliceCount':{type:'int',group:'Misc',defaultValue:12},'metadataFile':{type:'sap.ui.core.URI',group:'',defaultValue:null},'showRangeSelector':{type:'boolean',group:'Appearance',defaultValue:true},'showTableView':{type:'boolean',group:'Appearance',defaultValue:false},'showTableValue':{type:'boolean',group:'Appearance',defaultValue:true},'showToolbar':{type:'boolean',group:'Appearance',defaultValue:true},'width':{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:'100%'}},events:{'doubletap':{},'tap':{}}}});sap.apb.makit.Chart.M_EVENTS={'doubletap':'doubletap','tap':'tap'};\r\n/*!\r\n * @copyright@\r\n */\r\nsap.apb.makit.Chart.TypeMapping={'column':'Column','line':'Line','pie':'Pie','bar':'Bar','bubble':'Bubble','stackcolumn':'StackColumn','hundredpercentstackcolumn':'HundredPercentStackColumn','waterfallcolumn':'WaterfallColumn','waterfallbar':'WaterfallBar'};sap.apb.makit.Chart.DummyMetadata=''+'<Chart Name=\"makitChartDummy\" ChartType=\"column\">'+'<Category Column=\"DummyCategory\"/>'+'<Values>'+'<Value Expression=\"DummyValues\"/>'+'</Values>'+'</Chart>';\r\nsap.apb.makit.Chart.getDummyJSONData=function(){var d=new window.$MA.DataTable();d.addColumn('DummyCategory','string');d.addColumn('DummyValues','number');d.addRow(['','']);return d};\r\nsap.apb.makit.Chart.checkSizeTimer=null;sap.apb.makit.Chart.registeredElems={};sap.apb.makit.Chart.registeredHandlers={};\r\nsap.apb.makit.Chart.registerResizeHandler=function(e,h){if(!sap.apb.makit.Chart.registeredElems[e.id]){sap.apb.makit.Chart.registeredElems[e.id]=e;sap.apb.makit.Chart.registeredHandlers[e.id]=h;e.currentOffsetHeight=0;e.currentOffsetWidth=0}if(!sap.apb.makit.Chart.checkSizeTimer){sap.apb.makit.Chart.checkSizeTimer=setTimeout(sap.apb.makit.Chart.checkSize,200)}};\r\nsap.apb.makit.Chart.checkSize=function(){for(var e in sap.apb.makit.Chart.registeredElems){var a=sap.apb.makit.Chart.registeredElems[e];if(a&&(a.currentOffsetHeight!=a.offsetHeight||a.currentOffsetWidth!=a.offsetWidth)){a.currentOffsetHeight=a.offsetHeight;a.currentOffsetWidth=a.offsetWidth;sap.apb.makit.Chart.registeredHandlers[a.id]()}}sap.apb.makit.Chart.checkSizeTimer=setTimeout(sap.apb.makit.Chart.checkSize,200)};\r\nsap.apb.makit.Chart.prototype.init=function(){this._initialized=false;this._makitType='simple';this._hasZoomingLevel=false;this._makitChart=null;this._parentCurrentHeight=0;this._selectedCatIdx=0;this._chartTypeDefined=false;this._legendPosDefined=false;this._metadataString=null;this._metadataXmlDoc=null;this._chartList={'Content':[]};this._customisedProps={};this._metadataValues={};this._styleClasses=[];this.attachEvent('_change',this._onPropertyChanged);sap.ui.getCore().attachThemeChanged(this._applyCSS,this)};\r\nsap.apb.makit.Chart.prototype.onBeforeRendering=function(e){this.fireEvent('_beforeRendering',this);if(this.getDomRef()&&!sap.ui.core.RenderManager.isPreservedContent(this.getDomRef())){sap.ui.core.RenderManager.preserveContent(this.getDomRef(),true,false)}};\r\nsap.apb.makit.Chart.prototype.onAfterRendering=function(e){this.fireEvent('_afterRendering',this);var $=jQuery(jQuery.sap.domById('sap-ui-dummy-'+this.getId()));var a=sap.ui.core.RenderManager.findPreservedContent(this.getId());var b=null;if(a.size()==0){this.fireEvent('_createMAKitObject',this);b=new jQuery(this.getDomRef());$.replaceWith(b);this._createChartObject();var c=this.getDomRef();sap.apb.makit.Chart.registerResizeHandler(c,jQuery.proxy(this._onResize,this))}else if(a.size()>0){this.fireEvent('_restoreMAKitObject',this);$.replaceWith(a);var c=this.getDomRef();if(c!=null){c.style.width=this.getWidth();c.style.height=this.getHeight()}}else{$.remove()}};\r\nsap.apb.makit.Chart.prototype.addStyleClass=function(s,S){if(this._styleClasses.indexOf(s)===-1){this._styleClasses.push(s)}if(this._makitChart){sap.ui.core.Control.prototype.addStyleClass.call(this,s,S)}return this};\r\nsap.apb.makit.Chart.prototype.removeStyleClass=function(s,S){var i=this._styleClasses.indexOf(s);if(i>-1){this._styleClasses.splice(i,1)}if(this._makitChart){sap.ui.core.Control.prototype.removeStyleClass.call(this,s,S)}return this};\r\nsap.apb.makit.Chart.prototype.setProperty=function(t,v){this._customisedProps[t]=true;sap.ui.core.Control.prototype.setProperty.call(this,t,v)};\r\nsap.apb.makit.Chart.prototype.setDataSource=function(v){sap.ui.core.Control.prototype.setProperty.call(this,'dataSource',unescape(v))};\r\nsap.apb.makit.Chart.prototype._getXMLParser=function(x){var a;if(window.DOMParser){var p=new DOMParser();a=p.parseFromString(x,'text/xml')}else{a=new ActiveXObject('Microsoft.XMLDOM');a.async=false;a.loadXML(x)}return a};\r\nsap.apb.makit.Chart.prototype._loadAndParseMetadataUrl=function(){var m=this.getMetadataFile();if(m!=null&&m.trim()!==''){window.SAP.Util.loadFileByProject(m,this._parseMetadata,this._onLoadMetadataError,this)}else{this._makitChart=null;this._metadataXmlDoc=null;this._metadataValues={};this._dsSet=false;var e=this.getDomRef();if(e){while(e.hasChildNodes()){e.removeChild(e.lastChild)}}this._createChartObject()}};\r\nsap.apb.makit.Chart.prototype._parseMetadata=function(m){this._metadataXmlDoc=this._getXMLParser(m);this._metadataValues={};this._dsSet=false;this._makitChart=null;this._metadataValues['dataSource']=null;this._parseXMLNode(this._metadataXmlDoc.documentElement);if(this._customisedProps['dataSource']===undefined){this._metadataValues['dataSource']=this._metadataValues['dataSource']===null?'':this._metadataValues['dataSource'];this.setDataSource(this._metadataValues['dataSource'])}this._initialized=true;this._createChartObject()};\r\nsap.apb.makit.Chart.prototype._parseXMLNode=function(c){this._makitType='simple';var i,j;var a=c.childNodes;var l=a.length;for(i=0;i<l;i++){var b=a[i];if(b.nodeType===1){this._parseXMLNode(b)}}var n=c.nodeName.toLowerCase();var d=c.attributes;var e=d.length;var f='';for(j=0;j<e;j++){var g=d[j];var h=g.nodeName.toLowerCase();var k=g.nodeValue;if(h==='name'&&n=='chart'){f=k;break}}var m=0;if(n=='drilldowngroup'){this._makitType='drilldowngroup'}else if(n=='zoominglevel'){this._hasZoomingLevel=true}else if(n=='chart'){}for(j=0;j<e;j++){var g=d[j];var h=g.nodeName.toLowerCase();var k=g.nodeValue;if(h==='charttype'&&n=='chart'){this._metadataValues['type']=sap.apb.makit.Chart.TypeMapping[k];if(this._initialized||this._customisedProps['type']===undefined){this.setType(sap.apb.makit.Chart.TypeMapping[k]);this._customisedProps['type']=undefined}}else if(h==='query'&&(n=='chart'||n=='zoominglevel')){this._metadataValues['dataSource']=this._metadataValues['dataSource']===null?unescape(k):this._metadataValues['dataSource'];if(this._initialized||this._customisedProps['dataSource']===undefined){var o=this._formatQueryString(unescape(k));g.nodeValue=o;this._customisedProps['dataSource']=undefined}}else if(h==='sortorder'&&n=='category'){this._metadataValues['categorySortOrder']=sap.apb.makit.Chart.TypeMapping[k];if(this._initialized||this._customisedProps['categorySortOrder']===undefined){this.setCategorySortOrder(k);this._customisedProps['categorySortOrder']=undefined}}}};\r\nsap.apb.makit.Chart.prototype._onLoadMetadataError=function(e){this._makitChart=null;var a=this.getDomRef();if(a){while(a.hasChildNodes()){a.removeChild(a.lastChild)}}throw new Error(e)};\r\nsap.apb.makit.Chart.prototype._createChartObject=function(){var a=this.getDomRef();if(a==null){return}a.style.width=this.getWidth();a.style.height=this.getHeight();var m=null;var b=this.getMetadataFile();if((b==null||b.trim()==='')&&this._metadataXmlDoc===null){m=sap.apb.makit.Chart.DummyMetadata;this.usingDummyData=true}else if(this._metadataXmlDoc!=null){this.usingDummyData=false;m=this._metadataXmlDoc.xml?this._metadataXmlDoc.xml:(new XMLSerializer()).serializeToString(this._metadataXmlDoc)}else{return}try{if(this._makitType==='drilldowngroup'){this._makitChart=new window.$MA.DrillDownGroup(this.getId(),true)}else{this._makitChart=new window.$MA.Chart(this.getId(),true)}var t=this;this._makitChart.bind('initialized',function(){t._setMakitChartProperties()});this._makitChart.bind('renderend',function(){t._setMakitChartProperties()});this._makitChart.bind('beforerender',function(){t.fireEvent('_makitBeforeRender',t)});this._makitChart.bind('renderstart',function(){t.fireEvent('_makitRenderStart',t)});this._makitChart.bind('renderend',function(){t.fireEvent('_makitRenderEnd',t)});this._makitChart.bind('animationend',function(){t.fireEvent('_makitAnimationEnd',t)});this._makitChart.create(m);this._makitChart.bind('tap',function(){t._selectedCatIdx=t._makitChart.getSelectedCategoryIndex();t.fireTap({})});this._makitChart.bind('doubletap',function(){t.fireEvent('doubletap',t)});this._makitChart.bind('longpress',function(){t._selectedCatIdx=t._makitChart.getSelectedCategoryIndex();t.fireEvent('longpress',t)})}catch(e){jQuery.sap.log.getLogger('sap.apb.makit.Chart').error('failed to create the chart',this.getId(),'sap.apb.makit.Chart');this._makitChart=null}};\r\nsap.apb.makit.Chart.prototype._setMakitChartProperties=function(){if(!this._makitChart){return}var m=this._makitChart;if(this._makitType==='drilldowngroup'){m=this._makitChart.getCurrentChart()}m.setProperty('category.sortorder',this.getCategorySortOrder().toLowerCase());m.showToolBar(this.getShowToolbar());m.showTableView(this.getShowTableView());m.showRangeSelectorView(this.getShowRangeSelector());m.setGraphLineWidth(this.getLineThickness());m.showTableValue(this.getShowTableValue());m.setMaxPies(this.getMaxSliceCount());m.setLegend(this.getLegendPosition());if(this.usingDummyData){this._makitChart.setDataTable(sap.apb.makit.Chart.getDummyJSONData());this._makitChart.showValueBubble(false)}else{var d=this.getDataSource();this._setChartQuery(d)}var t=this;this._makitChart.bind('renderend',function(){var c=m.getProperty('ChartType');var a=t.getType();if(a){c=c?c.toLowerCase():c;a=a.toLowerCase();if(c!==a){m.setProperty('ChartType',a)}}})};\r\nsap.apb.makit.Chart.prototype._applyCSS=function(e){if(this._makitChart){this._makitChart.applyCSS()}};\r\nsap.apb.makit.Chart.prototype._onResize=function(e){var a=this.getDomRef();if(this._makitChart!=null&&a&&a.offsetHeight>0&&a.offsetWidth>0){this._makitChart.refresh()}};\r\nsap.apb.makit.Chart.prototype._onPropertyChanged=function(e){var n=e.mParameters['name'];var a=e.mParameters['newValue'];if(n==='metadataFile'){this._loadAndParseMetadataUrl()}else if(this._makitChart){var m=this._makitChart;if(this._makitType==='drilldowngroup'){m=this._makitChart.getCurrentChart()}if(n==='type'){var t=a.toLowerCase();m.setProperty('ChartType',t)}else if(n==='showRangeSelector'){m.showRangeSelectorView(a)}else if(n==='showToolbar'){m.showToolBar(a)}else if(n==='showTableView'){m.showTableView(a)}else if(n==='legendPosition'){m.setLegend(a.toLowerCase())}else if(n==='width'){this.getDomRef().style.width=a}else if(n==='height'){this.getDomRef().style.height=a}else if(n==='lineThickness'){m.setGraphLineWidth(a)}else if(n==='maxSliceCount'){m.setMaxPies(a)}else if(n==='showTableValue'){m.showTableValue(a)}else if(n==='categorySortOrder'){m.setProperty('category.sortorder',a.toLowerCase())}else if(n==='dataSource'){if(a.trim()===''){if(typeof this._metadataValues['dataSource']=='string'&&this._metadataValues['dataSource'].trim()!==''){this._customisedProps['dataSource']=undefined;this.setDataSource(this._metadataValues['dataSource'])}}else{this.usingDummyData=false;this._makitChart.showValueBubble(true);this._setChartQuery(a)}}m.setSelectedCategoryIndex(this._selectedCatIdx);this._makitChart.refresh()}};\r\nsap.apb.makit.Chart.prototype.getMetadataValue=function(p){return this._metadataValues[p]};\r\nsap.apb.makit.Chart.prototype.getSelectedCategory=function(){var s=undefined;if(this._makitChart){s=this._makitChart.getSelectedCategory()}return s};\r\nsap.apb.makit.Chart.prototype.getSelectedSeries=function(){var s=undefined;if(this._makitChart){s=this._makitChart.getSelectedSeries()}return s};\r\nsap.apb.makit.Chart.prototype.getNumberOfCategories=function(){var n=undefined;if(this._makitChart){n=this._makitChart.getNumberOfCategories()}return n};\r\nsap.apb.makit.Chart.prototype._setChartQuery=function(d,p){if(!this._makitChart){return}var a=this._hasZoomingLevel?'zoominglevels[0].':'';var n=this._formatQueryString(d,p);var m=this._makitChart;if(this._makitType==='drilldowngroup'){m=this._makitChart.getChartAtIndex(0)}m.setProperty(a+'query',n)};\r\nsap.apb.makit.Chart.prototype._formatQueryString=function(q,p){if(q.indexOf('datasource|')<0){q='datasource|'+q}if(p){q+='|'+p}return q};\r\nsap.apb.makit.Chart.prototype.refreshData=function(){if(!this._makitChart){return}var p=this._hasZoomingLevel?'zoominglevels[0].':'';var m=this._makitChart;if(this._makitType==='drilldowngroup'){m=this._makitChart.getChartAtIndex(0)}var q=m.getProperty(p+'query');m.setProperty(p+'query',q)};\r\n",
	"sap.apb.makit.ChartRenderer":"/*!\r\n * @copyright@\r\n */\r\njQuery.sap.declare('sap.apb.makit.ChartRenderer');sap.apb.makit.ChartRenderer={};\r\nsap.apb.makit.ChartRenderer.render=function(r,c){r.write(\"<div id=\\\"sap-ui-dummy-\"+c.getId()+\"\\\" style=\\\"display:none\\\">\");r.write('<div');r.writeControlData(c);r.writeAttribute('data-sap-ui-preserve',c.getId());r.addClass('sapMakitChart');r.writeClasses();r.write('>');r.write('</div>');r.write('</div>')};\r\n",
	"sap.apb.makit.library":"jQuery.sap.declare('sap.apb.makit.library');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');sap.ui.getCore().initLibrary({name:'sap.apb.makit',dependencies:['sap.ui.core'],types:['sap.apb.makit.ChartType','sap.apb.makit.LegendPosition','sap.apb.makit.SortOrder'],interfaces:[],controls:['sap.apb.makit.Chart'],elements:[],version:'1.14.0'});jQuery.sap.declare('sap.apb.makit.ChartType');sap.apb.makit.ChartType={Column:'Column',Line:'Line',Bubble:'Bubble',Bar:'Bar',Pie:'Pie'};jQuery.sap.declare('sap.apb.makit.LegendPosition');sap.apb.makit.LegendPosition={Top:'Top',Left:'Left',Bottom:'Bottom',Right:'Right',None:'None'};jQuery.sap.declare('sap.apb.makit.SortOrder');sap.apb.makit.SortOrder={Ascending:'Ascending',Descending:'Descending',None:'None'};\r\n"
}}
